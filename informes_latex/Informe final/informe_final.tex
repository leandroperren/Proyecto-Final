\documentclass{article}
\usepackage{lmodern}
\usepackage[T1]{fontenc}
\usepackage[spanish,activeacute]{babel}
\usepackage{multirow}
\usepackage{float}
\usepackage{graphicx}

\graphicspath{ {images/} }
\setlength{\parskip}{10pt}
\renewcommand\theenumii{\theenumi.\arabic{enumii}}

\title{Desarrollo de métodos inteligentes para la detección y clasificación de ronquidos }
\author{Leandro Perren - Matias Meurzet}

\begin{document}
% cuerpo del documento

\maketitle
\tableofcontents

\newpage

\section*{Indice}

Agradecimientos

Resumen

\begin{enumerate}
\item Introducción
\begin{enumerate}
\item Motivación.
\item Estado del arte.
\item Organización de la tesis.
\end{enumerate}
\item Método de detección de ronquidos por medio del T0.
\begin{enumerate}
\item Cálculo del T0 y comparación entre segmentos de distintas señales
\begin{enumerate}
\item Análisis señales correspondientes a hombres
\item Análisis señales correspondientes a mujeres
\end{enumerate}
\item Comparación de T0 entre hombres y mujeres
\item Análisis de sonidos no deseados (ruidos)
\item Mejora a través de funciones de recorte
\item Cantidad mínima de ronquidos por segmento
\item Tasas de aciertos del método en Matlab.
\end{enumerate}
\item Desarrollo de aplicación Android
\begin{enumerate}
\item Análisis y definición de requerimientos
\item Diseño del sistema y del software
\item Integración y prueba del sistema
\item Tasas de aciertos aplicación Android.
\end{enumerate}
\item Conclusión
\item Bibliografia
\item Anexos
\end{enumerate}

\newpage

\section*{Resumen}

En la actualidad existen distintas herramientas para la detección de ronquidos de uso doméstico, las cuales van desde elementos diseñados especialmente como almohadas inteligentes o pulseras hasta diferentes aplicaciones para dispositivos móviles. Todos ellos consisten del análisis de una señal capturada por medio del micrófono del dispositivo. La problemática con estos métodos es que solamente realizan un análisis de la señal en busca de cambios bruscos del nivel de energía, lo cual hace que las aplicaciones sean poco robustas a los ruidos que se pueden presentar en un entorno cotidiano bajo condiciones normales. El objetivo de esta tesis es desarrollar una aplicación Android capaz de detectar episodios de ronquidos mediante la captura por medio del micrófono del dispositivo y que sea robusta frente al ruido. 
Es por esto que se propone un método basado en el cálculo del T0 por medio de la autocorrelacion. Este método usado por la aplicacion recorrera por ventaneo en tiempo real toda la  señal capturada por el dispositivo y determinara si el T0 de esa ventana cae dentro de un rango determinado para que sea considerado ronquido. Este rango de T0 se determina mediante la extracción de una gran cantidad de ronquidos sacados de señales EDF provistas por un especialista de trastornos de sueño y que consisten de señales limpias de personas de ambos sexos. La base de este método propuesto esta en la naturaleza cuasi-periódica que los ronquidos presentan y que los ruidos no, a su vez la ventaja de utilizar el T0 se basa en que únicamente se analiza temporalmente la señal y que se puede utilizar señales de baja frecuencia (100Hz) lo que genera un costo computacional, de almacenamiento y de consumo de energía mucho menor que el de otros metodos que utilizan además carácteristicas frecuenciales.
\newpage

\section{Introducción}
\subsection{Motivación} 
El ronquido es un sonido respiratorio producido durante el sueño pudiendo ser inspiratorio, espiratorio o bien ocupar todo el ciclo respiratorio. El surgimiento se debe a que el flujo de aire encuentra una obstrucción al pasar por detrás de la boca y la nariz, en donde la lengua y la parte superior de la garganta se encuentran con el paladar blando y la úvula. El choque de estas estructuras sumado al paso de la respiración determina la presencia del ronquido.

La importancia de la detección de esta patología excede el simple hecho de evitar roncar por las noches, esta situación puede ocasionar trastornos sociales al impedir el sueño de aquellos que rodeen al roncador, así como también producir el conocido Síndrome de Apneas Obstructivas del Sueño (SAOS). 

Actualmente existen numerosas herramientas y dispositivos que permiten detectar esta patología en una persona. Dentro de éstas se encuentran diferentes aplicaciones disponibles para dispositivos móviles (smartphones) que cuenten con sistema operativo (OS) Android [6] o AppleiOS[7],ejemplos de las mismas son las aplicaciones SnoreClock y AntiSnore para Android y, AntiRonquidos y SnoreLab para dispositivos iPhone. Otros dispositivos que se encuentran disponibles hoy en día y que suelen ser menos frecuentes y más costosos son, por ejemplo, Snore-detection pillow [9] o almohada detectora de ronquidos, las pulseras detectoras, las cuales son colocadas en la muñeca como si se tratara de un reloj, además de una cama inteligente (The Starry Night Sleep Technology Bed) [8] que dispone de un dispositivo de detección y ajuste de la posición de la cabeza para que los sonidos cesen. Algunos de los dispositivos mencionados para la detección de esta patología (principalmente dispositivos móviles) están basados en un simple análisis de la señal de audio digital, capturada por el dispositivo, buscando cambios bruscos que superen un umbral dado de energía, indicando así la presencia de ronquido.

La problemática de los métodos actuales mencionados, radica en el hecho de que no cualquier sonido que supere cierto umbral de energía es un ronquido. Este problema se puede presentar de manera habitual cuando un individuo realiza la grabación en un ambiente natural como una habitación, en la cual se pueden adicionar muchos ruidos. Se entiende como ruido toda aquella información no deseada que se encuentre contenida en la señal bajo análisis, generando inconvenientes, pudiendo ser estos tanto externos (colectivos, motos, vecinos, etc.) como internos (charlas, música, TV, cierre brusco de puerta, etc.) incorporando una gran cantidad de energía a la señal, siendo eventualmente detectados como ronquido. 

Desde esta problemática, surge la posibilidad de poder desarrollar una aplicación para dispositivos móviles la cual utilizando métodos más inteligentes que los actuales, sea capaz de reconocer y clasificar ronquidos, a partir de la captura de una señal de audio digital mediante el micrófono de un dispositivo movil (smartphone), realizando el análisis de la misma y bajo la aplicación de diversos conocimientos: 

\begin{enumerate}
 \item Mecánica de la respiración.
\item Fisiología y anatomía de la vía aérea superior (VAS).
\item Procesamiento de señales.
\item Informática.
\end{enumerate}

La importancia de la mecánica de la respiración [5] y de la fisiología y anatomía de la vía aérea superior (VAS) [5]: fosas nasales, faringe y laringe, reside en el conocimiento funcional del aparato respiratorio para comprender por qué se produce el ronquido. El funcionamiento incorrecto de alguna de sus partes provoca la oclusión intermitente de la VAS que predispone el desarrollo de la roncopatía. La informática [12][13] es una ciencia que estudia métodos, procesos y técnicas con el fin de almacenar, procesar y transmitir información y datos en formato digital. Los campos aplicables para este estudio van desde la ciencia de la computación hasta la ingeniería de software para el desarrollo de una solución integral de computo y comunicación capaz de procesar información de manera automática. El procesamiento de señales [10] permite la manipulación matemática de la señal para modificarla, mejorarla y extraer información en algún sentido con el fin de obtener las características necesarias para una posterior clasificación. 

El método que se desarrola en esta tesis presenta el desafío de lograr una detección y clasificación de ronquidos con la mayor tasa de aciertos posible. Para ello es preciso realizar un estudio exhaustivo de las características temporales de diferentes ronquidos de manera tal que la detección y clasificación, aún en presencia de ruido, presenten una gran robustez. Al estudiar los diferentes ronquidos se debe tener presente las condiciones del entorno en el que se capture la señal, ya que esto tendrá incidencia directa en la amplia variedad de ruidos que pueden afectarla. Otros posibles aspectos a considerar son las características personales de quien se capture la señal, es decir: edad, género, índice de masa corporal, adicciones como alcoholismo y tabaquismo, entre otras, ya que influyen en las características del ronquido mismo.  

Se pretende mediante este trabajo proporcionar una alternativa inteligente respecto a los métodos actuales de detección de ronquidos, además de ser un punto inicial para futuros desarrollos tecnológicos, no necesariamente software sobre teléfonos inteligentes (smartphones), sino también para otros dispositivos que pretendan incorporar inteligencia a fin de detectar el ronquido para llevar a cabo alguna acción determinada. A su vez se espera que sirva de base sólida para futuros trabajos que logren ampliar su alcance llevándolo a la detección y clasificación de otros trastornos como es el caso del SAOS[5]. 

\subsection{Estado del arte}
Aca segun mi parecer deberiamos analizar brevemente alguna de las apps disponibles y describir algunos de los papers que utilizan señales de estudios de sueños (IEEE).

\subsection{Organización de la tesis}
Esta tesis presenta la siguiente estructura:
\begin{itemize}
\item En el presente capítulo se describió la motivación de este desarrollo y el problema que será abordado. Se presenta una revisión
del estado del arte de dispositivos y aplicaciones destinados a detectar ronquidos, como también se describen trabajos investigativos orientados a la detección de los mismos utilizando señales obtenidas en estudios de sueños. Finalmente, se describe la estructura de capítulos.
\item En el capítulo 2 se describe el método de detección desarrollado en esta tesis. Primeramente se describe la extracción de ronquidos y calculo del T0 de las señales limpias EDF y se determinan en base a ellos una serie de parámetros. Para finalizar se presentan las tasas de acierto del algoritmo detector desarrollado en Matlab utilizando las señales limpias EDF.    
\item En el capítulo 3 se presenta el desarrollo de la aplicación Android. Primeramente se desarrollan las distintas etapas propuestas por la Ingeniería de Software. Luego se calculan las tasas de aciertos de la aplicación realizando distintas pruebas tanto con señales limpias (EDF) como en entornos cotidianos propensos a un alto contenido de ruidos.
\item El capítulo 4 dispone de las conclusiones particulares y generales como también de propuestas de futuros trabajos que podrían derivar del presente.
\end{itemize}

\section{Método de detección de ronquidos por medio del T0}

Para este trabajo se dispuso de una cantidad de 23 señales de formato EDF, correspondientes a estudios de sueño, tanto de personas de sexo masculino como femenino. Las mismas se obtuvieron por medio de un médico especialista en trastornos de sueño y, consisten de la grabación del sueño de toda una noche (7hs promedio). 

De acuerdo a la extracción y análisis de distintos segmentos de las señales que fueron etiquetados como ronquidos por el sistema médico Apnealink, se pudo observar que estos segmentos contienen una serie de concentraciones de energía separados entre sí, de manera que presentan cierta repetitividad o periodicidad, tal como se aprecia en el segmento de la Figura 1.

\begin{figure}[H]
	\centering
		\includegraphics[width=1\columnwidth]{figure1}	
	\caption[Energia ronquidos]{Segmento de 1 minuto etiquetado como ronquidos.}
\end{figure}

Dada la baja tasa de muestreo que presenta la señal en cuestión, surge la idea de que es posible medir la periodicidad de eventos de ronquido recién expuestos, a través del T0 (Período Fundamental), partiendo de la hipótesis de que aquellos segmentos que contienen sonidos no deseados (todo lo que no sea ronquido), no presentan este patrón repetitivo, permitiendo así poder hacer uso de ésta característica para diferenciarlos entre sí.

Con el fin de utilizar el T0 para diferenciar segmentos de ronquidos de aquellos que no lo son, resulta necesario analizar si el T0 es una característica representativa de los ronquidos, en el sentido de que deberían presentar cierta homogeneidad en los valores obtenidos de segmentos provenientes de diferentes señales. Es por esto que en las siguientes secciones se presentan los resultados obtenidos de extraer segmentos de ronquidos de diferentes duraciones y de distintas señales de ambos sexos a los cuales se le calcula el correspondiente T0 y se determina si los mismos presentan cierta homogeneidad.



\subsection{Cálculo del T0 y comparación entre segmentos de distintas señales}
Se comenzó tomando las señales *.EDF, las cuales contienen de manera complementaria un archivo de extensión *.CSV, el cual contiene el etiquetado de la señal, realizado por el sistema médico Apnealink. Este etiquetado permite utilizar las señales de manera tal de extraer segmentos que contengan realmente eventos de ronquidos.
Todas estas señales fueron registradas por dicho sistema a una frecuencia de muestreo de 100 Hz. Por dicha causa, se procedió solamente al análisis temporal, dejando de lado el análisis frecuencial, ya que allí las técnicas convencionales no resultan factibles de utilizar.

Debido a que se dispone de señales de personas de ambos sexos resulta interesante realizar el análisis separadamente a fin de determinar si existen diferencias notables en los ronquidos producidos por hombres o mujeres ya que esto podría implicar la necesidad de indicar el género en la aplicación a desarrollar en esta tésis. 
Por otra parte también se procede a extraer segmentos de diferentes duraciones con el objetivo de determinar si la variación de la misma implica variaciones importantes en los valores de T0 y asi poder determinar un valor óptimo de duración del segmento. 


\subsection*{Análisis señales correspondientes a hombres}
En esta sección se presentan los resultados obtenidos de los análisis realizados a señales de hombres. Para ello se toman 5 señales *.EDF dejando algunas señales para las pruebas finales del método. Para cada una de estas señales se extraen manualmente segmentos de ronquidos de distintas duraciones, de 30 segundos, 1, 2, 3 y 5 minutos, puntualmente se extraen 5 segmentos de cada una de estas duraciones. Posteriormente por medio de un script desarrollado en Matlab el cual utiliza el método de autocorrelación se procede a calcular para cada uno de estos segmentos su valor de T0 y su inversa F0 (frecuencia fundamental). En la Figura 2 se encuentran representados en la parte superior un segmento de 1 minuto el cual contiene ronquidos y en la parte inferior su correspondiente autocorrelación. 
Se puede observar en la gráfica de la autocorrelación la existencia de un valor pico en torno a los 4 segundos, este valor pico corresponde al T0 de los ronquidos contenidos en el segmento. 
\begin{figure}[H]
	\centering
		\includegraphics[width=1\columnwidth]{figure2}	
	\caption[Energia ronquidos]{Segmento con ronquidos y su autocorrelación.}
\end{figure}

En el Cuadro 1 podemos ver los valores del T0 y F0 de 5 segmentos de ronquidos de 1 minuto de duración todos extraídos de la misma señal en diferentes momentos, al final se encuentran la media y desvío estándar para los T0 y F0.

\begin{table}[htbp]
\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
Ronquido & Hora (HH:MM:SS) & T0 (s) & F0 (Hz) \\
\hline \hline
1 & 03:33:59 & 4.15 & 0.24 \\ \hline
2 & 02:12:12 & 4.68 & 0.21 \\ \hline
3 & 02:11:04 & 4.86 & 0.21 \\ \hline
4 & 03:24:43 & 3.96 & 0.25 \\ \hline
5 & 04:33:24 & 3.79 & 0.26 \\ \hline
\multicolumn{2}{|r|}{Media} & 4.29 & 0.23 \\ \hline
\multicolumn{2}{|r|}{Desvío Estándar} & 0.46 & 0.023 \\ \hline
\end{tabular}
\caption{T0 y F0 de segmentos de 1 minuto de duración.}
\label{tabla:Ronquidos}
\end{center}
\end{table}

Como primer punto se analiza que sucede con los T0 entre segmentos de una misma señal. Si se observa el valor del Desvío Estándar para los T0 de los segmentos con ronquidos presentados en el Cuadro 1, podemos observar que tiene un valor de 0.46 segundos lo cual es un valor pequeño que estaría indicando cierta homogeneidad. Debido a que se extrajeron segmentos de distintas señales se puede observar en el Cuadro 2 los valores del Desvío Estandar de los T0 de cada señal y para cada duración de segmentos. Viendo estos datos se concluye que cualquiera sea la duración utilizada en los segmentos, los valores del desvío estándar son menores a 1 segundo, con lo cual estamos asegurándonos que la caracteristica T0 es homogénea entre segmentos de ronquidos de una misma señal. 
Por lo tanto, se hace evidente el poder utilizar esta característica (T0) para detectar distintos segmentos de ronquidos a lo largo de una grabación, en distintos momentos de la misma.
 

\begin{table}[H]
\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
Señal & \multicolumn{5}{|c|}{Desvio estandar del T0} \\
\hline \hline
& 1 min & 30 seg & 2 min & 3 min & 5 min \\ \hline
Paciente 1 & 0.46 & 0.47 & 0.46 & 0.43 & 0.24 \\ \hline
Paciente 2 & 0.35 & 0.22 & 0.27 & 0.14 & 0.31 \\ \hline
Paciente 3 & 0.25 & 0.12 & 0.20 & 0.21 & 0.26 \\ \hline
Paciente 4 & 0.52 & 0.61 & 0.62 & 0.70 & 0.85 \\ \hline
Paciente 5 & 0.09 & 0.24 & 0.17 & 0.17 & 0.08 \\ \hline
\end{tabular}
\caption{Desvíos estándar de los T0 de cada señal para distintas duraciones.}
\label{tabla:Ronquidos}
\end{center}
\end{table}

A continuación se analiza que sucede con los valores del T0 comparandolo entre segmentos de distintas señales...

\end{document}